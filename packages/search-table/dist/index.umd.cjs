(function(l,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("ant-design-vue"),require("lodash-es")):typeof define=="function"&&define.amd?define(["exports","vue","ant-design-vue","lodash-es"],e):(l=typeof globalThis<"u"?globalThis:l||self,e(l.FlatanSeachTable={},l.vue,l["ant-design-vue"],l.lodashEs))})(this,function(l,e,p,h){"use strict";const C={class:"search-table-wrapper"},w={class:"search-table-filters-action-btn-wrapper"},S=e.defineComponent({__name:"index",props:["options"],setup(c,{expose:f}){var b;const r=c,i=e.ref(!1),s=e.ref({}),a=e.ref({page:1,current:1,pageSize:10,showLessItems:!0,showSizeChanger:!0,showQuickJumper:!0,showTotal:t=>`共有 ${t} 项`,onChange:t=>T(t),onShowSizeChange:(t,u)=>B(u),...(b=r.options)==null?void 0:b.pagination}),o=e.ref({fetchNow:!0}),m=e.ref([]),g=()=>{a.value.page=1,a.value.current=1,d()},_=()=>{Object.keys(s.value).forEach(t=>s.value[t]=null)},d=async()=>{if(!i.value)try{i.value=!0,o.value.beforeQuery&&o.value.beforeQuery(s.value);const{total:t,page:u,pageSize:n,...y}=a.value,v=await o.value.fetchMethod({...s.value,page:u,size:Number(n)});a.value.current=u,r.options.pagination.total||(a.value.total=v.total),m.value=v.rows}catch{}finally{i.value=!1}},T=t=>{a.value.page=t,d()},B=t=>{a.value.pageSize=t,d()};return e.onMounted(()=>{o.value.fetchNow&&o.value.fetchMethod&&d()}),e.watch(()=>r.options,()=>{o.value=h.merge(r.options,o.value),a.value=h.merge(a.value,r.options.pagination)},{immediate:!0}),f({fetch:d,reset:_,search:g}),(t,u)=>(e.openBlock(),e.createElementBlock("div",C,[e.createElementVNode("div",{class:e.normalizeClass(["search-table-filters",o.value.formClass])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value.formOptions,n=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(n.type),e.mergeProps({key:n.name,placeholder:n.label,allowClear:!0,class:"search-table-filters-item"},n.$attrs,{value:s.value[n.name],"onUpdate:value":y=>s.value[n.name]=y}),null,16,["placeholder","value","onUpdate:value"]))),128))],2),e.createElementVNode("div",w,[e.renderSlot(t.$slots,"beforeBtn",{},void 0,!0),e.createVNode(e.unref(p.Button),{type:"primary",onClick:g},{default:e.withCtx(()=>[e.createTextVNode("查询")]),_:1}),e.createVNode(e.unref(p.Button),{onClick:_},{default:e.withCtx(()=>[e.createTextVNode("重置")]),_:1}),e.renderSlot(t.$slots,"afterBtn",{},void 0,!0)]),e.createVNode(e.unref(p.Table),e.mergeProps({class:"search-table-body",columns:o.value.tableCol,dataSource:m.value,scroll:{x:"max-content"},loading:i.value,pagination:a.value,tableLayout:"fixed"},t.$attrs),{bodyCell:e.withCtx(n=>[e.renderSlot(t.$slots,"bodyCell",e.normalizeProps(e.guardReactiveProps(n)),void 0,!0)]),_:3},16,["columns","dataSource","loading","pagination"])]))}}),N="",k=((c,f)=>{const r=c.__vccOpts||c;for(const[i,s]of f)r[i]=s;return r})(S,[["__scopeId","data-v-6b90ebc0"]]),x={install:c=>{c.component("SearchTable",k)}};l.default=x,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
