(function(l,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue"),require("ant-design-vue"),require("lodash-es")):typeof define=="function"&&define.amd?define(["exports","vue","ant-design-vue","lodash-es"],e):(l=typeof globalThis<"u"?globalThis:l||self,e(l.FlatanSeachTable={},l.vue,l["ant-design-vue"],l.lodashEs))})(this,function(l,e,u,y){"use strict";const v={class:"search-table-wrapper"},C={class:"search-table-filters-action-btn-wrapper"},w=e.defineComponent({__name:"index",props:["options"],setup(s,{expose:f}){const i=s,c=e.ref(!1),r=e.ref({}),n=e.ref({page:1,current:1,size:"10",showLessItems:!0,showSizeChanger:!1,showQuickJumper:!0,showTotal:t=>`共有 ${t} 项`,onChange:t=>S(t)}),a=e.ref({fetchNow:!0}),h=e.ref([]),m=()=>{n.value.page=1,n.value.current=1,d()},_=()=>{Object.keys(r.value).forEach(t=>r.value[t]=null)},d=async()=>{if(!c.value)try{c.value=!0,a.value.beforeQuery&&a.value.beforeQuery(r.value);const{total:t,page:p,size:o,...b}=n.value,g=await a.value.fetchMethod({...r.value,page:p,size:Number(o)});n.value.current=p,n.value.total=g.total,h.value=g.rows}catch{}finally{c.value=!1}},S=t=>{n.value.page=t,d()};return e.onMounted(()=>{a.value.fetchNow&&a.value.fetchMethod&&d()}),e.watch(()=>i.options,()=>{a.value=y.merge(i.options,a.value)},{immediate:!0}),f({fetch:d,reset:_,search:m}),(t,p)=>(e.openBlock(),e.createElementBlock("div",v,[e.createElementVNode("div",{class:e.normalizeClass(["search-table-filters",a.value.formClass])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value.formOptions,o=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(o.type),e.mergeProps({key:o.name,placeholder:o.label,allowClear:!0,class:"search-table-filters-item"},o.$attrs,{value:r.value[o.name],"onUpdate:value":b=>r.value[o.name]=b}),null,16,["placeholder","value","onUpdate:value"]))),128))],2),e.createElementVNode("div",C,[e.renderSlot(t.$slots,"beforeBtn",{},void 0,!0),e.createVNode(e.unref(u.Button),{type:"primary",onClick:m},{default:e.withCtx(()=>[e.createTextVNode("查询")]),_:1}),e.createVNode(e.unref(u.Button),{onClick:_},{default:e.withCtx(()=>[e.createTextVNode("重置")]),_:1}),e.renderSlot(t.$slots,"afterBtn",{},void 0,!0)]),e.createVNode(e.unref(u.Table),e.mergeProps({class:"search-table-body",columns:a.value.tableCol,dataSource:h.value,scroll:{x:"max-content"},loading:c.value,pagination:n.value,tableLayout:"fixed"},t.$attrs),{bodyCell:e.withCtx(o=>[e.renderSlot(t.$slots,"bodyCell",e.normalizeProps(e.guardReactiveProps(o)),void 0,!0)]),_:3},16,["columns","dataSource","loading","pagination"])]))}}),T="",k=((s,f)=>{const i=s.__vccOpts||s;for(const[c,r]of f)i[c]=r;return i})(w,[["__scopeId","data-v-ab16d9dd"]]),x={install:s=>{s.component("SearchTable",k)}};l.default=x,Object.defineProperties(l,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
